## 1 准备环境

  1. 软件Windows、msys2、mingw32

### 下载msys2:

#### x64版本:

	从"http://www.msys2.org/" 下载 "msys2-x86_64-xxx.exe"
#### x86版本:

	从"http://www.msys2.org/" 下载 "msys2-i686-xxx.exe"

### 安装msys2:

	根据这篇文章 "http://blog.csdn.net/liyuanbhu/article/details/39397931"

###  在msys2安装mingw32

#### 第一步 安装基本软件

            mingw32_shell.bat  

            pacman --needed -Sy bash pacman pacman-mirrors msys2-runtime  

            exit  

              

            mingw32_shell.bat  

            pacman -Syu  

            pacman -S  base-devel git clang zsh nano  

            pacman -S  mingw-w64-i686-toolchain  

      

#### 第二步 配置 /home/xx/.zshrc or /home/xx/.bashrc

         export PATH="/mingw32/bin:/mingw32/lib:/mingw32/include:/usr/local/bin:/usr/bin:/bin:/opt/bin"  

         alias msystem="echo $MSYSTEM"  

         alias md='mkdir -p'  

         alias grepi='grep -i --color=no'  

         alias grepci='grepc -i'           

         mdcd(){md $1;cd $1};  

         alias a=alias  

           

         a pms='pm -Ss $1|grepci $1'  

         a pmi='pm -S'  

         a pmr='pm -R'  

         m3head_for_pm=mingw-w64-i686  

         m3pms(){pm -Ss $1|grepi $m3head_for_pm|grepci $1};  

         m3pmi(){pmi  $m3head_for_pm-$*};  

         m3pmr(){pmr  $m3head_for_pm-$*};  

         m3head=mingw32  

         

#### 第三步 安装必要的工具

        m3pmi ncurses  

        m3pmi openal  

        m3pmi glfw  

        m3pmi freeglut  

        m3pmi nanovg-git  

        m3pmi libwebsockets  

        m3pmi readline  

      

## 2 源码编译

### 2.1下载源码

    mingw32_shell.bat  
    cd ~/  
    mdcd repo  
    mdcd github  
    mdcd evilbinary  
    git clone https://github.com/evilbinary/scheme-lib.git  
    cd scheme-lib/        

        

### 2.2 修改

    nano makefile  
    #ifeq ($(UNAME_S), MINGW32_NT-6.1)  
    ifneq ($(findstring "MINGW32_NT-", $(UNAME_S)), "")  
    (sav&close nano)  
    [在shell里面 "uname -s" 看看就知道要改成什么了]  

### 2.3 修改 简化
            cd lib/  
            nano makefile   
#### 1)  修改判断
                #ifeq ($(UNAME_S), MINGW32_NT-6.1)  
                ifneq ($(findstring "MINGW32_NT-", $(UNAME_S)), "")

                  

#### 2) 注释不需要库 

                #LIBS_ALL= libscm.so libimgui.so libglfw.so libffi.so libgles.so libnanovg.so \  

                #libalut.so libgui.so libsocket.so libc.so  

                LIBS_ALL= libscm.so libc.so  

                (sav&clos nano)  



### 2.4 复制, 然后make

            cp -r platform/windows/.  .  
            cd ..  
            make clean &make  
            (ok!)  
            #测试  

            cp lib/scheme/scheme.exe bin/scheme.exe

            ./scheme  

            ctrl+c  

            

### 2.5 逐步放开库

    nano scheme-lib/makefile  

    LIBS_ALL=libscm.so libimgui.so libglfw.so libffi.so libgles.so libnanovg.so \  

    libalut.so libgui.so libsocket.so libc.so  

    #逐一增加进LIBS_ALL然后make:  

#### 1)
	
	如果缺少xx.dll  
	
	就进修改lib/xx/makefile:  
	
	ifneq ($(findstring "MINGW32_NT-", $(UNAME_S)), "")  

#### 2)

    (1)失败 就 直接把x.so 文件 改成x.dll

#### 3)

    增加 libalut.so 后, (2)也失败  

    需要把scheme-lib-2.0-win32/bin/libalut.dll 放到 lib/libalut/ 中,  

    然后 make  

    (ok了)



### 2.6 保存文件

    在lib/libalut/里:    
	ren makefile makefile.ori  
	
	echo all:>makefile  
	
	echo clean:>>makefile

